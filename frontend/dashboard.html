<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard de Ventas - Cafetería</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Font Awesome para iconos -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- CSS personalizado -->
  <link rel="stylesheet" href="assets/css/dashboard.css">
</head>
<body>
  
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <i class="fas fa-coffee"></i> Sistema de Ventas - Cafetería
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link active" href="dashboard.html">
              <i class="fas fa-chart-line"></i> Dashboard
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="products.html">
              <i class="fas fa-box"></i> Productos
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="register-sale.html">
              <i class="fas fa-cash-register"></i> Registrar Venta
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Contenedor principal -->
  <div class="container-fluid py-4">
    
    <!-- Header con título y filtros -->
    <div class="row mb-4">
      <div class="col-lg-6">
        <h1 class="h3 mb-3">
          <i class="fas fa-chart-bar text-primary"></i> Dashboard de Análisis de Ventas
        </h1>
      </div>
      <div class="col-lg-6">
        <div class="card">
          <div class="card-body">
            <div class="row g-2 align-items-center">
              <div class="col-auto">
                <label class="form-label mb-0">Filtrar por período:</label>
              </div>
              <div class="col-auto">
                <select class="form-select form-select-sm" id="periodFilter">
                  <option value="all">Todo</option>
                  <option value="today">Hoy</option>
                  <option value="week" selected>Última semana</option>
                  <option value="month">Último mes</option>
                  <option value="custom">Personalizado</option>
                </select>
              </div>
              <div class="col-auto" id="customDateRange" style="display: none;">
                <input type="date" class="form-control form-control-sm" id="startDate">
              </div>
              <div class="col-auto" id="customDateRangeEnd" style="display: none;">
                <input type="date" class="form-control form-control-sm" id="endDate">
              </div>
              <div class="col-auto">
                <button class="btn btn-primary btn-sm" id="applyFilter">
                  <i class="fas fa-filter"></i> Aplicar
                </button>
              </div>
              <div class="col-auto">
                <button class="btn btn-success btn-sm" id="exportCSV">
                  <i class="fas fa-file-csv"></i> Exportar CSV
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- KPIs - Tarjetas de métricas principales -->
    <div class="row mb-4">
      <!-- Ingresos Totales -->
      <div class="col-xl-3 col-md-6 mb-3">
        <div class="card stat-card stat-card-revenue">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <p class="card-label mb-1">Ingresos Totales</p>
                <h3 class="card-value mb-0" id="totalRevenue">$0.00</h3>
                <small class="text-muted" id="revenueChange">+0% vs período anterior</small>
              </div>
              <div class="stat-icon bg-primary">
                <i class="fas fa-dollar-sign"></i>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Total de Ventas -->
      <div class="col-xl-3 col-md-6 mb-3">
        <div class="card stat-card stat-card-sales">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <p class="card-label mb-1">Total de Ventas</p>
                <h3 class="card-value mb-0" id="totalSales">0</h3>
                <small class="text-muted" id="salesChange">+0% vs período anterior</small>
              </div>
              <div class="stat-icon bg-success">
                <i class="fas fa-shopping-cart"></i>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Ticket Promedio -->
      <div class="col-xl-3 col-md-6 mb-3">
        <div class="card stat-card stat-card-average">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <p class="card-label mb-1">Ticket Promedio</p>
                <h3 class="card-value mb-0" id="averageTicket">$0.00</h3>
                <small class="text-muted" id="ticketChange">+0% vs período anterior</small>
              </div>
              <div class="stat-icon bg-warning">
                <i class="fas fa-receipt"></i>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Productos Vendidos -->
      <div class="col-xl-3 col-md-6 mb-3">
        <div class="card stat-card stat-card-products">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <p class="card-label mb-1">Productos Vendidos</p>
                <h3 class="card-value mb-0" id="totalProductsSold">0</h3>
                <small class="text-muted">unidades totales</small>
              </div>
              <div class="stat-icon bg-info">
                <i class="fas fa-box-open"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Gráficos principales -->
    <div class="row mb-4">
      
      <!-- Gráfica de ventas por día (Barras) -->
      <div class="col-lg-8 mb-3">
        <div class="card chart-card">
          <div class="card-header bg-white">
            <h5 class="card-title mb-0">
              <i class="fas fa-chart-bar text-primary"></i> Ingresos Diarios
            </h5>
          </div>
          <div class="card-body">
            <canvas id="dailySalesChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Gráfica de productos más vendidos (Pastel) -->
      <div class="col-lg-4 mb-3">
        <div class="card chart-card">
          <div class="card-header bg-white">
            <h5 class="card-title mb-0">
              <i class="fas fa-chart-pie text-success"></i> Top Categorías
            </h5>
          </div>
          <div class="card-body">
            <canvas id="categoriesChart"></canvas>
          </div>
        </div>
      </div>

    </div>

    <!-- Segunda fila de gráficos -->
    <div class="row mb-4">
      
      <!-- Tendencia de ventas (Línea) -->
      <div class="col-lg-8 mb-3">
        <div class="card chart-card">
          <div class="card-header bg-white">
            <h5 class="card-title mb-0">
              <i class="fas fa-chart-line text-info"></i> Tendencia de Ventas
            </h5>
          </div>
          <div class="card-body">
            <canvas id="trendChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Top 10 productos más vendidos -->
      <div class="col-lg-4 mb-3">
        <div class="card chart-card">
          <div class="card-header bg-white">
            <h5 class="card-title mb-0">
              <i class="fas fa-trophy text-warning"></i> Top 10 Productos
            </h5>
          </div>
          <div class="card-body">
            <div class="table-responsive" style="max-height: 400px;">
              <table class="table table-sm table-hover">
                <thead class="table-light sticky-top">
                  <tr>
                    <th>#</th>
                    <th>Producto</th>
                    <th>Vendidos</th>
                    <th>Ingresos</th>
                  </tr>
                </thead>
                <tbody id="topProductsTable">
                  <tr>
                    <td colspan="4" class="text-center text-muted">
                      <i class="fas fa-spinner fa-spin"></i> Cargando datos...
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Análisis por categorías -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card">
          <div class="card-header bg-white">
            <h5 class="card-title mb-0">
              <i class="fas fa-layer-group text-primary"></i> Análisis Descriptivo por Categorías
            </h5>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-striped table-hover">
                <thead class="table-dark">
                  <tr>
                    <th>Categoría</th>
                    <th>Productos</th>
                    <th>Unidades Vendidas</th>
                    <th>Ingresos Totales</th>
                    <th>Promedio por Producto</th>
                    <th>% del Total</th>
                  </tr>
                </thead>
                <tbody id="categoryAnalysisTable">
                  <tr>
                    <td colspan="6" class="text-center text-muted">
                      <i class="fas fa-spinner fa-spin"></i> Cargando análisis...
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Loading overlay -->
  <div id="loadingOverlay" style="display: none;">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Dashboard JS -->
  <script src="assets/js/dashboard.js"></script>

</body>
</html>